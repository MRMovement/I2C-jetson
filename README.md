<<<<<<< HEAD
# ÓĞ¹ØÖ±½Óµ÷ÓÃjetson nano I2C½Ó¿ÚÇı¶¯PCA9685Çı¶¯°åµÄËµÃ÷
~~½ö¸öÈËÀí½â£¬»¹ÍûÖ¸Õı~~
## jetson nano40Òı½ÅËµÃ÷
```doc
    jetson NanoÉÏ´øÓĞ40¸öÒı½Å£¬·Ö±ğÓĞ²»Í¬µÄ¹¦ÄÜ£¬ÎÒÃÇÖ÷ÒªÕâ´ÎÊÇËµÃ÷ÆäÖĞµÄI2C½Ó¿Ú£¬Jetson NanoÉÏÓĞ2¸öI2C½Ó¿Ú£¬Ò»¸ö½Ó¿ÚÕ½Á½¸öÒı½Å£¬·Ö±ğÊÇ
    SDA,SCL£¬ÆäÖĞÒı½ÅÎ»·Ö±ğÊÇ×ÜÏß0£º27£¬28 ×ÜÏß1£º3£¬5 ·Ö±ğ¶ÔÓ¦×ÅÒ»Ìõ×ÜÏß£¬¸ù¾İĞèÇó¿ÉÒÔÑ¡Ôñ5ÖÖ¹¤×÷Ä£Ê½¡££¨ÕâÀïËµÃ÷Ò»ÏÂ£¬SDAÊÇÊı¾İÏß£¬
    ÔÚºóĞø¶ÔµØÖ·´«ÊäĞÅÏ¢Ê±ºòÖ÷ÒªÓÃµÄÏß£¬SCLÊÇ¿ØÖÆÏß£¬Ò²ÊÇÊ±ÖÓÏß£¬ÓÃÓÚ¿ØÖÆÖÜÆÚ£©Á·ÏßÉÏ£¬ÒòÎªÒ»Ö±ÏÔÊ¾²»´í×ÜÏß1µÄµØÖ·£¬×îºóÑ¡ÔñÁË×ÜÏß0
    ½«PCA9685Çı¶¯°åÉÏµÄSDAÓëjetson nano ÉÏµÄ27£¨I2C_1_SDA£©ÏàÁ¬£¬SCLÓë28£¨I2C_1_SCL£©Ïà»¥Á¬£¬È»ºó½«VCC½èÔÚ3.3VµÄµçÔ´½Ó¿Ú£¬GEN½ÓµØ
    Á¬ÏßÉÏµÄËµÃ÷¾ÍÊÇÕâÑùÁË¡£
```
![Ê¾ÀıÍ¼Æ¬](img/Á¬Ïß1.jpg)  <br />
![Ê¾ÀıÍ¼Æ¬](img/Á¬Ïß2.jpg)  <br />

## ¹©µçÒÔ¼°Ê¹ÓÃ·½·¨
```doc
    ÔÚÍê³É»ù±¾Á¬Ïßºó£¬»¹ĞèÒªÕÒµ½Ò»¸ö5-10VµÄÍâ½ÓµçÔ´£¬¹ı´ó¿ÉÄÜÒıÆğ½ÓÏß¹ıÈÈËğº¦Æ÷¼ş£¬²¢ÇÒ×¢Òâ¾ø¶Ô²»ÄÜ·´½Ó£¬Çı¶¯°åÊÇÃ»ÓĞ±£»¤»úÖÆµÄ£¬·´½Óºó´ó¸ÅÂÊËğ»µ¡£
    ÕÒµ½Íâ½ÓµçÔ´ºó½ÓÈëÁ½¸öÍâ½ÓVCC GEN£¬Æğµ½¹©µç×÷ÓÃ£¬³ıÁË×îĞ¡µÄÇı¶¯¶æ»ú£¬ÆäËûÔªÆ÷¼ş¶¼ĞèÒªÍâ½ÓµçÔ´²ÅÄÜ¹¤×÷¡£ÖÁ´Ë£¬»ù±¾µÄ×¼±¸ËãÊÇÍê³ÉÁË£¬È»ºó¾ÍÊÇ
    Æø±Ã£¬µç´Å·§Á¬½ÓÎÊÌâ£¬¾ßÌå¿ÉÒÔ¿´ÉÌ¼ÒµÄÊÓÆµ£¬ËãÊÇÏêÏ¸µÄÁË£¬¼ÙÉèÕâĞ©Á¬½ÓºÃºó£¬ÎÒÃÇÑ¡ÔñÇı¶¯°åÉÏµÄ16¸öPWM½Ó¿ÚÖĞµÄÁ½¸ö£¬Á¬½ÓºÃ£¬²¢¼Ç×¡Î»ÖÃ£¬½ÓÏÂÀ´
    ÊÇ´úÂëºÍjetsonÉè±¸ÎÊÌâ¡£

```

## jetsonÉè±¸ÎÊÌâ
---
    Ê×ÏÈ£¬ÎÒÃÇĞèÒª¶ÔjetsonµÄÏµÍ³×öÒ»Ğ©´¦Àí£¬ÔÚÎÒÃÇ×Ô¼ºÉÕÂ¼ÏµÍ³ºó£¬I2CÊÇÄ¬ÈÏÔÚºÚÃûµ¥ÖĞµÄ£¬Ò²¾ÍÊÇÄ¬ÈÏ¹Ø±ÕµÄµÄ£¬ĞèÒªÊÖ¶¯¿ªÆô£¬
    Í¨¹ıÖÕ¶Ë£¬ÔÚ Ê¹ÓÃvim ½øÈëµ½/etc/modprobe.d/blacklist.conf ÖĞ£¬×¢ÊÍµô blacklist i2c_i801 
---
![Ê¾ÀıÍ¼Æ¬](img/¿ªÆôI2C_1.png)  <br />

    È»ºó±£´æÍË³ö£¬ÔÙÈ»ºó£¬Í¨¹ı vim ½øÈëµ½/etc/modules ÖĞ£¬ÔÚµÄ×îºóÃæ×·¼Ói2c-dev ±£´æºó£¬ <br />

![Ê¾ÀıÍ¼Æ¬](img/¿ªÆôI2C_2.png)  <br />

    ÔÙÔÚÖÕ¶ËÖĞÊäÈë£¬ sudo reboot ÖØÆô£¬´ËÖÂ¾ÍÍê³ÉÁËI2CµÄÉèÖÃ¡£
    ×îºó¾ÍÊÇÒ»Ğ©±ØÒªµÄ¿âµÄ°²×°
    sudo apt-get install i2c-tools//ÕâÊÇÓÃÀ´²é¿´I2C×ÜÏßÍ¨µÀµÄµØÖ·£¬·½±ã¼ì²éI2CÊÇ·ñ³É¹¦Á¬½ÓÉÏ¡£
    sudo apt-get install python3-smbus //ÕâÊÇ×îÖ÷ÒªµÄ¿â£¬Ö±½ÓÉæ¼°µ½¿ØÖÆ²Ù×÷
    sudo apt-get install libi2c-dev
    Èç¹û°²×°Óöµ½ÎÊÌâ£¬ÀàËÆÎŞ·¨ÕÒµ½Èí¼ş°üÕâÀà£¬Çë¸ü»»¾µÏñÔ´
    ÏÈ cp /etc/apt/sources.list /etc/apt/sources.list.bak ±¸·İÔ­À´µÄÎÄ¼ş
    ÔÙcd /etc/apt/sources.list½øÈë¾µÏñÔ´ÎÄ¼şÖĞ£¬½«ÏÂÁĞ¸²¸ÇµôÔ­ÄÚÈİ£¬ÕâÀïÍÆ¼öµÄÊÇ°¢ÀïÔ´
    deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
    deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
    deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
    deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
    deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
    deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
    deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
    deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
    deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
    deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
---
    i2c-tools ÃüÁî¼ò½é
    i2cdetect ¨C ÓÃÀ´ÁĞ¾Ù I2C bus ÉÏÃæµÄËùÓĞ×°ÖÃ 
    i2cdump ¨C ÏÔÊ¾×°ÖÃÉÏËùÓĞ register µÄÖµ 
    i2cget ¨C ¶ÁÈ¡×°ÖÃÉÏÄ³¸ö register µÄÖµ 
    i2cset ¨C Ğ´Èë×°ÖÃÉÏÄ³¸ö register µÄÖµ
---

## ²âÊÔ
---

Í¨¹ısudo i2cdetect -y -r 0£¬¿ÉÒÔ²é¿´jetson×ÜÏß0ÊÇ·ñ³É¹¦Á¬½Ó£¬ÒòÎªPCA9685Ä¬ÈÏµØÖ·ÊÇ0x40µ½0x70£¬Òò´ËÕıÈ·²Ù×÷ÏÂ£¬Äã¿ÉÒÔ¿´µ½ÕâÑùµÄÏÔÊ¾¡£ <br />
![Ê¾ÀıÍ¼Æ¬](img/µØÖ·Î».png)  <br />
ÕâÖÖÇé¿öËµÃ÷½ÓÏßÃ»ÓĞÎÊÌâ£¬Èç¹ûÃ»ÓĞÏÔÊ¾µØÖ·£¬ĞèÒª¼ì²éÊÇ·ñÓĞ²½Öè´íÎó¡£

---

## Ê¹ÓÃ
×îºó¾ÍÊÇÊ¹ÓÃÎÊÌâ£¬Ê²Ã´²Ù×÷Ã»ÎÊÌâºó¾Í¿ÉÒÔÖ±½ÓÊ¹ÓÃpython´úÂëÇø²Ù×÷PWMÊä³ö¿ØÖÆËùĞèÒªµÄÆ÷¼ş£¬ÕâÀï¶Ô´úÂë×ö³öÒ»µã½â¶Á£¬¾ßÌåÄÚ²¿Ò²ÓĞĞí¶à×¢ÊÍ£¬Ê×ÏÈÊÇĞèÒªµÄ¿âµÄ£¬Ö®Ç°°²×°µÄsmbus¿â¾ÍÊÇ×¨ÃÅÓÃÀ´¿ØÖÆI2CµÄÒ»¸ö¿â£¬ÔÚ£¬Ê¹ÓÃÇ°£¬¿ÉÒÔÈ¥²é¿´¹Ù·½µÄPCA9685µÄµØÖ·Î»<br />
ÆäÖĞÖ÷ÒªÊÇÊÇ²Ù×÷Ä£Ê½Î» __MODE1 ÕâÀïÎÒÃÇÑ¡Ä£Ê½Î»1Ò²¾ÍÊÇµØÖ·0x00 ÔÚÊ¹ÓÃ¸Ã¼Ä´æÆ÷µÄÊ±ºòÒª×¢Òâ£ºÈç¹ûÎ´Í£Ö¹ËùÓĞPWMÊä³ö¾Í½«Æä½øÈëµ½Ë¯ÃßÄ£Ê½£¬ÄÇÃ´£¬ËùÓĞÊä³öÍ¨µÀÔÚÏÂÒ»ÂÖ¶¼½«Êä³ö¸ßµçÆ½¡£Õâ¿ÉÄÜ»áÓ°ÏìËùÒÔÉè±¸µÄÊ¹ÓÃ£¬Ò»¶¨Òª×¢Òâ£¬ÒÔ¼°ÔÚÉèÖÃPWMÆµÂÊ(Ğ´PRESCALE¼Ä´æÆ÷)µÄÊ±ºò£¬ÒªÏÈÉèÖÃÎªSleepÄ£Ê½ <br />
È»ºóÖ÷ÒªÊÇÂö¿í(Õ¼¿Õ±È)ÉèÖÃ¼Ä´æÆ÷µØÖ·£ºÒ»¸öPWM¿Ú£¬ÓÉ4¸öµØÖ·½øĞĞ¿ØÖÆLED0_ON_L,LED0_ON_H,LED0_OFF_L,LED0_OFF_H£¬ËÄ¸ö¹²Í¬¿ØÖÆÒ»¸öPWM¿Ú£¬ÕâÀïÒ²ÊÇÄ¬ÈÏµÚÒ»¸ö¿Ú£¬ËÄ¸öµØÖ·Î»·Ö±ğÊÇ0x06£¬0x07£¬0x08,0x09£¬ÎÒÃÇÖ»Ğè¼ÇÂ¼µÚÒ»Î»µØÖ·¾Í¿ÉÒÔ£¬ÒòÎªºóĞø¶¼ÊÇ½ô°¤×ÅµÄËÄÎ»µØÖ·¡£ <br />
ÕâÊÇËÄ¸öÍ¨µÀ¼Ä´æÆ÷µÄÔ­ÀíÍ¼: <br />
![Ê¾ÀıÍ¼Æ¬](img/µØÖ·Î».png)  <br />
![Ê¾ÀıÍ¼Æ¬](img/µØÖ·Î».png)  <br />
¸ù¾İĞèÇóÇøÉèÖÃ£¬ÎÒÃÇÊ¹ÓÃµÄÊÇÆø±Ã£¬ĞèÒª×Ô¼ºµ÷²éÆô¶¯ÆµÂÊ£¬ÎÒÊ¹ÓÃµÄÆø±ÃÖÜÆÚ¿ÉÒÔ´ïµ½1500usÒÔÉÏ¾Í¿ÉÒÔÆô¶¯£¬µç´Å·§ÒàÈç´Ë£¬Òò´Ë¿ÉÒÔÊ¹ÓÃÀàËÆ¶æ»úµÄÉèÖÃ£¬½«
ÖÜÆÚÉèÖÃ³É50hz£¬Âö¿í·¶Î§ÔÚ0.5-2.5msÖ®¼ä£¬Ö»Òª´óÓÚ1.5ms¾ÍÊÇµç´Å·§µÄ¿ªÆô£¬´óÓÚ¾ÍÊÇÔö´óÎüÁ¦£¬Ğ¡ÓÚÔòÊÇÎŞ·¨Æô¶¯¡£
×îºóÊÇÖÜÆÚ(ÆµÂÊ)ÉèÖÃ¼Ä´æÆ÷£ºPRE_SCALE µØÖ·Î»ÊÇ£º0xFE¡£ <br />
Ê£ÏÂµÄÌí¼ÓµÄµØÖ·ÊÇÎªÁËºóĞø¿ÉÄÜĞèÒªÓÃµ½µÄ²Ù×÷Ìí¼ÓµÄ£¬ÏÖ½×¶Î²¢Ã»ÓĞÊµÖÊµÄ×÷ÓÃ¡£<br />
²¹³äËµÃ÷£ºµç´Å·§ºÍÆø±ÃµÄ¹¤×÷Ô­Àí¿ÉÒÔÇø¹Ù·şÊÖ²á²é¿´£¬¼òµ¥µÄËµ£¬ÔÚÄã¿ªÆôÆø±ÃÆÚ¼äÊÇ²»ÔËÆø¿ªÆôµç´Å·§µÄ£¬ĞèÒªÆø±Ã¹Ø±Õºó²Å¿ÉÒÔ¿ªÆô£¬Í¬Àí
µç´Å·§Ò²ÊÇĞèÒªÆø±Ã¹Ø±Õºó²ÅÄÜ¿ªÆô£¬²¢ÇÒµç´Å·§¿ªÆôµÄÊ±¼ä²»ÒË¹ı³¤£¬·ñÔòµç´Å·§»á·¢ÈÈµ¼ÖÂËğº¦£¬ÔÚÓÃÍæºóÓ¦¸ÃÁ¢¿Ì¹Ø±Õ¡£<br />
½ÓÏÂÀ´ÏêÇé¿ÉÒÔÇø´úÂëÇø²é¿´



=======
å¾…åŠ å·¥
>>>>>>> 39402eb8bdf41c57514cbee21bc2e431d9e7fa3b
